var tempErrorCreds,tempProviderName;function retrieveIdToken(e,n){null!==firebase.auth().currentUser?firebase.auth().currentUser.getIdToken().then((function(n){var o={token:n,displayName:firebase.auth().currentUser.displayName};void 0!==e&&e(o)})).catch((function(e){console.log(e),void 0!==n&&n(e.message)})):null!==n&&n("User is null")}function anonymousLogin(e,n){void 0!==e&&e({token:"",displayName:"guest"})}function firebaseLogin(e,n,o){if("anonymous"!==e){var t=firebase.auth().currentUser;if(null==t||t.isAnonymous){var i=getProvider(e);firebase.auth().useDeviceLanguage(),firebase.auth().signInWithPopup(i).then((function(e){console.log("Successful sign in"),retrieveIdToken(n,o)})).catch((function(e){var n=e.code,t=(e.message,e.email);tempErrorCreds=e.credential,console.log(e),void 0!==o&&o(e.message),"auth/account-exists-with-different-credential"===n&&firebase.auth().fetchSignInMethodsForEmail(t).then((function(e){0!=e.length&&(tempProviderName=e[0].trim(),setModalContent("generalModalContent",'<div id ="continueWindow"><span class="close" id="closeButton" onclick="hideModal(\'generalModal\')">&times;</span><p>Please press the button to login: </p><button onclick="continueLogin()">Continue Login</button></div>'),showModal("generalModal"))}))}))}else retrieveIdToken(n,o)}else anonymousLogin(n,o)}function firebaseLogout(){firebase.auth().signOut().catch((function(e){console.log(e)}))}function getCurrentUserDisplayName(){var e=firebase.auth().currentUser,n="";return e&&(n=e.displayName),n}function getProvider(e){return e&&-1!=e.indexOf("facebook")?new firebase.auth.FacebookAuthProvider:new firebase.auth.GoogleAuthProvider}function setModalContent(e,n){content=document.getElementById(e),content&&(content.innerHTML=n)}function continueLogin(){hideModal("generalModal");var e=getProvider(tempProviderName);firebase.auth().signInWithPopup(e).then((function(e){tempErrorCreds&&e.user.linkAndRetrieveDataWithCredential(tempErrorCreds).then((function(e){}))}))}function showModal(e){modal=document.getElementById(e),modal&&(modal.style.display="block")}function hideModal(e){modal=document.getElementById(e),modal&&(modal.style.display="none")}